<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>plotRaster — plotRaster • SEraster</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="plotRaster — plotRaster"><meta name="description" content="Function based on ggplot2::geom_tile to visualize a rasterized spatial omics dataset represented as a SpatialExperiment object."><meta property="og:description" content="Function based on ggplot2::geom_tile to visualize a rasterized spatial omics dataset represented as a SpatialExperiment object."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SEraster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.99.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/install.html">Install</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/formatting-SpatialExperiment-for-SEraster.html">Formatting a SpatialExperiment Object for SEraster</a></li>
    <li><a class="dropdown-item" href="../articles/getting-started-with-SEraster.html">Getting Started With SEraster</a></li>
    <li><a class="dropdown-item" href="../articles/SEraster-for-SVG-analysis.html">SEraster for Spatial Variable Genes Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/characterizing-mPOA-cell-type-heterogeneity.html">Characterizing mPOA cell-type heterogeneity with spatial bootstrapping</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JEFworks-Lab/SEraster/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>plotRaster</h1>
      <small class="dont-index">Source: <a href="https://github.com/JEFworks-Lab/SEraster/blob/HEAD/R/main.R" class="external-link"><code>R/main.R</code></a></small>
      <div class="d-none name"><code>plotRaster.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function based on <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_tile</a></code> to visualize a rasterized spatial omics dataset represented as a <code>SpatialExperiment</code> object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotRaster</span><span class="op">(</span></span>
<span>  <span class="va">input</span>,</span>
<span>  assay_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  feature_name <span class="op">=</span> <span class="st">"sum"</span>,</span>
<span>  factor_levels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  showLegend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plotTitle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  showAxis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-input">input<a class="anchor" aria-label="anchor" href="#arg-input"></a></dt>
<dd><p><code>SpatialExperiment</code>: Input data represented as a
<code>SpatialExperiment</code>. The given <code>SpatialExperiment</code> is assumed to have
an <code>assay</code> slot containing a features-by-observations matrix as <code>dgCmatrix</code>
or <code>matrix</code> and a <code>colData</code> slot containing <code>sfc_POLYGON</code> geometry
of pixels. The features-by-observations matrix is assumed to have either genes
or cell types as features and pixels as observations.</p></dd>


<dt id="arg-assay-name">assay_name<a class="anchor" aria-label="anchor" href="#arg-assay-name"></a></dt>
<dd><p><code>character</code>: Name of the assay slot of the input that
you want to visualize. If no argument is given, the first assay of the input
would be visualized. This argument is useful when you have multiple assays stored
in the input, and you want to visualize a specific assay. Default is NULL.</p></dd>


<dt id="arg-feature-name">feature_name<a class="anchor" aria-label="anchor" href="#arg-feature-name"></a></dt>
<dd><p><code>character</code>: Name of the feature in the input that you
want to visualize. This argument is useful when you want to specify a feature you
want to visualize. You can also use "sum" to visualize sum of all feature
values per observation or "mean" to visualize mean of all feature values per observation.
Default is "sum".</p></dd>


<dt id="arg-factor-levels">factor_levels<a class="anchor" aria-label="anchor" href="#arg-factor-levels"></a></dt>
<dd><p><code>character</code> or <code>numeric</code> or <code>factor</code>: An
optional vector to convert and plot the input data as <code>factor</code>. This argument
is useful if you want to plot categorical/ordinal variables, such as binarized
occurrence of a specific cell type. <code>factor_levels</code> is fed into <code>levels</code>
argument of the <code>factor</code> function in base R. Default is NULL.</p></dd>


<dt id="arg-showlegend">showLegend<a class="anchor" aria-label="anchor" href="#arg-showlegend"></a></dt>
<dd><p><code>logical</code>: Boolean to show the legend. Default is TRUE.</p></dd>


<dt id="arg-plottitle">plotTitle<a class="anchor" aria-label="anchor" href="#arg-plottitle"></a></dt>
<dd><p><code>character</code>: An optional argument to add a title to the
resulting plot. Default is NULL.</p></dd>


<dt id="arg-showaxis">showAxis<a class="anchor" aria-label="anchor" href="#arg-showaxis"></a></dt>
<dd><p><code>logical</code>: Boolean to show axis title, texts, and ticks.
Default is FALSE.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional parameters to pass to <code><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">ggplot2::scale_fill_viridis_c</a></code>
if no argument is provided to <code>factor_levels</code> or <code><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">ggplot2::scale_fill_viridis_d</a></code>
if a vector is provided to <code>factor_levels</code>. If you wish to use other color
maps, we recommend overriding the resulting <code>ggplot</code> object.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The output is returned as a <code>ggplot</code> object, where the input is
visualized as <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">ggplot2::geom_sf</a></code>. Each pixel is plotted based on <code>sfc_POLYGON</code>
geometry stored in the <code>colData</code> slot. Coloring of pixel represent the corresponding
values of summarized (sum or mean) or specific feature (e.g. rasterized gene expression)
per observation (pixel).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"merfish_mousePOA"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># rasterize gene expression</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="rasterizeGeneExpression.html">rasterizeGeneExpression</a></span><span class="op">(</span><span class="va">merfish_mousePOA</span>, assay_name <span class="op">=</span> <span class="st">"volnorm"</span>, fun <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot total rasterized gene expression per pixel (there is only one assay_name </span></span></span>
<span class="r-in"><span><span class="co"># in out and default for feature_name argument is "sum"; therefore, these arguments </span></span></span>
<span class="r-in"><span><span class="co"># are not specified)</span></span></span>
<span class="r-in"><span><span class="fu">plotRaster</span><span class="op">(</span><span class="va">out</span>, name <span class="op">=</span> <span class="st">"total rasterized gexp"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotRaster-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot rasterized expression of a specific gene/feature per pixel</span></span></span>
<span class="r-in"><span><span class="fu">plotRaster</span><span class="op">(</span><span class="va">out</span>, feature_name <span class="op">=</span> <span class="st">"Esr1"</span>, name <span class="op">=</span> <span class="st">"Esr1"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotRaster-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># rasterize cell-type labels with user-defined resolution and hexagonal pixels</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="rasterizeCellType.html">rasterizeCellType</a></span><span class="op">(</span><span class="va">merfish_mousePOA</span>, col_name <span class="op">=</span> <span class="st">"celltype"</span>, resolution <span class="op">=</span> <span class="fl">50</span>, </span></span>
<span class="r-in"><span>square <span class="op">=</span> <span class="cn">FALSE</span>, fun <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot total cell counts per pixel (there is only one assay_name in out and default </span></span></span>
<span class="r-in"><span><span class="co"># for feature_name argument is "sum"; therefore, these arguments are not specified)</span></span></span>
<span class="r-in"><span><span class="co"># here, let's use additional parameters for ggplot2::scale_fill_viridis_c so </span></span></span>
<span class="r-in"><span><span class="co"># that it would have a different color scheme from gene expression plots</span></span></span>
<span class="r-in"><span><span class="fu">plotRaster</span><span class="op">(</span><span class="va">out</span>, name <span class="op">=</span> <span class="st">"total cell counts"</span>, option <span class="op">=</span> <span class="st">"inferno"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotRaster-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot specific cell type's cell counts per pixel</span></span></span>
<span class="r-in"><span><span class="fu">plotRaster</span><span class="op">(</span><span class="va">out</span>, feature_name <span class="op">=</span> <span class="st">"Inhibitory"</span>, name <span class="op">=</span> <span class="st">"Inhibitory neuron counts"</span>, option <span class="op">=</span> <span class="st">"inferno"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotRaster-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gohta Aihara, Mayling Chen, Lyla Atta, Jean Fan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

